
<style>
    /* Character Profile Section */
    .character-profile {
        display: flex;
        flex-wrap: wrap;
        gap: 1.5rem;
        align-items: flex-start;
    }

    .profile-main {
        display: flex;
        gap: 1.5rem;
        align-items: center;
        /*flex-basis: 320px;*/
        flex-grow: 1;
    }

    .character-portrait {
        width: 128px;
        height: 128px;
        background-color: #111;
        border: 1px solid #333;
        flex-shrink: 0;
        border-radius: 8px;
        overflow: hidden;
    }

    .profile-details h2 {
        margin: 0 0 0.5rem 0;
        font-size: 1.5em;
        color: #ffffff;
    }

    .profile-details p {
        margin: 0.25rem 0;
        color: #ccc;
        font-size: 0.95em;
    }

    .profile-stats {
        flex-basis: 320px;
        flex-grow: 2;
        display: flex;
        flex-direction: column;
        gap: 0.75rem;
        padding-top: 0.5rem;
    }

    .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
        gap: 0.5rem 1rem;
        margin-top: 1rem;
        background-color: #1a1a1a; /* Updated to match Main */
        border: 1px solid #333;    /* Added border to match Main */
        padding: 1rem;
        border-radius: 4px;
    }

    .talent-tag {
        background-color: #222; /* Updated to match Main */
        padding: 0.1rem 0.25rem;
        font-family: monospace;
        font-size: 0.85em;
        margin: 0.2rem;
        border: 1px solid #333;
        border-radius: 4px;
    }

    .mark-item {
        display: flex;
        align-items: center;
        gap: 1rem;
    }
    .mark-item .bar-label {
        flex-basis: 4.5rem;
        text-align: right;
        flex-shrink: 0;
    }

    /* Imprints Section - Grid layout */
    .marks-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 0.5rem;
    }
    .marks-grid .mark-item {
        justify-content: space-between;
        background-color: #1a1a1a; /* Updated to match Main */
        border: 1px solid #333;
        padding: 0.2rem 0.5rem;
        border-radius: 4px;
    }
    .marks-grid .mark-item .bar-label {
        flex-basis: auto;
        text-align: left;
    }

    /* Talents Tab - Flexbox layout for tags */
    #talents-content .info-grid {
        display: flex;
        flex-wrap: wrap;
        gap: 0.1rem 0.2rem;
    }
    #talents-content .info-grid h3 {
        width: 100%;
        margin-bottom: 0.5rem;
    }

    /* Abilities Tab - Grid layout */
    #abl-content .info-grid {
        grid-template-columns: repeat(auto-fit, minmax(170px, 1fr));
        align-items: center;
    }
    .abl-item {
        display: flex;
        align-items: center;
        gap: 1rem;
        padding: 0.2rem 0.5rem; 
        border: 1px solid #333; 
        border-radius: 4px; 
        background-color: #222; /* Updated */
        justify-content: space-between;
    }

    /* Experience Tab - Grid layout */
    #exp-content .info-grid {
        grid-template-columns: repeat(auto-fit, minmax(170px, 1fr));
    }
    
    .exp-list p, .appearance-content p {
        margin: 0 0 0.75rem 0;
        line-height: 1.6;
    }
    .exp-list p:last-child, .appearance-content p:last-child {
            margin-bottom: 0;
    }

    /* Equipment Section */
    .equipment-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 0.5rem;
    }
    .equipment-item {
        background-color: #222; /* Updated to match Main Inventory */
        padding: 0.5rem;
        border-radius: 4px;
        border: 1px solid #333;
    }
    .equipment-item .item-type {
        font-weight: bold;
        color: #60d9f7; /* Updated accent color */
        margin-right: 0.5em;
    }
    
    /* Narrative Tab */
    .narrative-block {
        margin-bottom: 1.5rem;
    }
    .narrative-block h3 {
        font-size: 1.1em;
        color: #ffffff;
        margin-bottom: 0.75rem;
        border-bottom: 1px solid #333;
        padding-bottom: 0.5rem;
    }
    .narrative-block p, .narrative-block ul {
        background-color: #1a1a1a; /* Updated */
        border: 1px solid #333;
        padding: 0.75rem;
        border-radius: 4px;
        line-height: 1.6;
        margin: 0;
    }
     .narrative-block ul {
        padding-left: 2.5rem;
     }

    @media screen and (max-width: 600px){
        .info-grid {
        grid-template-columns: repeat(auto-fill, minmax(120px, 1fr)) !important;
        gap: 0.75rem 0.5rem;
        }

        .marks-grid {
        grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)) !important;
        gap: 0.3rem 0.5rem;
        }
        
        .tab-content{
            padding: 1rem;
        }
        
        .equipment-item {
        padding: 0.2rem;
        font-size: 0.85rem;
        }
        
        .abl-item {
        font-size: 0.65rem;
        gap:0.3rem;
        padding: 0 0.2rem;
        }

        .talent-tag {
        font-size: 0.65rem;
        padding: 0.1rem 0.2rem;
        }
}
</style>

<div class="container">
<header class="header">
<h1>▋ 캐릭터 상세 정보</h1>
</header>
<div class="line double"></div>

<main>
<section class="character-profile">
<div class="profile-main">
<div class="character-portrait"><img src="{{#when::{{dict_element::{{getvar::target}}::이름}}::is::{{user}}}}{{source::user}}{{:else}}{{raw::{{dict_element::{{getvar::target}}::이름}}.png}}{{/when}}" style="margin:0px;border-radius:1em"></div>
<div class="profile-details">
<h2>{{dict_element::{{getvar::target}}::이름}} Lv.{{dict_element::{{getvar::target}}::레벨}}</h2>
<p><strong>종족:</strong> {{dict_element::{{getvar::target}}::종족}}</p>
<p><strong>성별:</strong> {{dict_element::{{getvar::target}}::성별}}</p>
<p><strong>클래스:</strong> {{dict_element::{{getvar::target}}::클래스}}</p>
<p><strong>나이:</strong> {{dict_element::{{getvar::target}}::나이}}</p>
</div>
</div>
<div class="profile-stats">
<div class="x-risu-bar-container">
<span class="bar-label">체력:</span>
<div class="progress-bar">
<div class="x-risu-progress-bar-fill x-risu-hp" style="width: {{calc::{{tonumber::{{dict_element::{{getvar::target}}::체력}}}} / {{tonumber::{{dict_element::{{getvar::target}}::최대체력}}}} * 100}}%;"></div>
</div>
<span class="bar-value">{{dict_element::{{getvar::target}}::체력}}/{{dict_element::{{getvar::target}}::최대체력}}</span>
</div>
<div class="x-risu-bar-container">
<span class="bar-label">기력:</span>
<div class="progress-bar">
<div class="x-risu-progress-bar-fill x-risu-st" style="width: {{calc::{{tonumber::{{dict_element::{{getvar::target}}::기력}}}} / {{tonumber::{{dict_element::{{getvar::target}}::최대기력}}}} * 100}}%;"></div>
</div>
<span class="bar-value">{{dict_element::{{getvar::target}}::기력}}/{{dict_element::{{getvar::target}}::최대기력}}</span>
</div>
<div class="stats-grid">
<span><strong>공격:</strong> {{dict_element::{{getvar::target}}::공격력}}</span>
<span><strong>방어:</strong> {{dict_element::{{getvar::target}}::방어력}}</span>
<span><strong>레이팅:</strong> {{dict_element::{{getvar::target}}::레이팅}}</span>
<span><strong>소지금:</strong> {{dict_element::{{getvar::target}}::소지금}}</span>
<span><strong>빚:</strong> {{dict_element::{{getvar::target}}::빚}}</span>
</div>
</div>
</section>

<div class="line single"></div>

<section class="detailed-info">
<div class="tabs-container">
<div class="tabs {{#if {{equal::{{getvar::category}}::appearance}}}}active{{/if}}" risu-btn="appearance">▋외모</div>
<div class="tabs {{#if {{equal::{{getvar::category}}::abl}}}}active{{/if}}" risu-btn="abl">▋능력</div>
<div class="tabs {{#if {{equal::{{getvar::category}}::talents}}}}active{{/if}}" risu-btn="talents">▋특성</div>
<div class="tabs {{#if {{equal::{{getvar::category}}::exp}}}}active{{/if}}" risu-btn="exp">▋경험</div>
<div class="tabs {{#if {{equal::{{getvar::category}}::narrative}}}}active{{/if}}" risu-btn="narrative">▋서사</div>
</div>
<div class="tab-content">
<div class="info-grid">
{{#when::category::vis::talents}}
<h3 style="margin:0">성격</h3>
<div>{{settempvar::성격::0}}
{{#each {{getvar::성격List}} T}}
{{#if {{? {{dict_element::{{getvar::target}}::{{slot::T}}}} == 1}}}}
{{settempvar::성격::1}}
<span class="talent-tag">[{{slot::T}}]</span>
{{/if}}
{{/each}}
{{#if {{? {{gettempvar::성격}}=0}}}}
<span class="talent-tag">[없음]</span>
{{/if}}
</div>
<h3 style="margin:0">신체특성</h3>
<div>{{settempvar::신체::0}}
{{#each {{getvar::신체특성List}} T}}
{{#if {{? {{dict_element::{{getvar::target}}::{{slot::T}}}} == 1}}}}
{{settempvar::신체::1}}
<span class="talent-tag">[{{slot::T}}]</span>
{{/if}}
{{/each}}
{{#if {{? {{gettempvar::신체}}=0}}}}
<span class="talent-tag">[없음]</span>
{{/if}}
</div>
<h3 style="margin:0">성적취향</h3>
<div>{{settempvar::취향::0}}
{{#each {{getvar::성적취향List}} T}}
{{#if {{? {{dict_element::{{getvar::target}}::{{slot::T}}}} == 1}}}}
{{settempvar::취향::1}}
<span class="talent-tag">[{{slot::T}}]</span>
{{/if}}
{{/each}}
{{#if {{? {{gettempvar::취향}}=0}}}}
<span class="talent-tag">[없음]</span>
{{/if}}
</div>
{{/when}}

{{#when::category::vis::abl}}
{{settempvar::ablCount::0}}
{{#each {{getvar::ablList}} abil}}
{{#if {{? {{dict_element::{{getvar::target}}::{{slot::abil}}}}!=0}}}}
{{settempvar::ablCount::1}}
<div class="abl-item"><span>{{slot::abil}}</span>
<div class="rating heart {{#when::{{dict_element::{{getvar::target}}::{{slot::abil}}}}::is::10}}is-full{{/when}}" style="--rating: {{dict_element::{{getvar::target}}::{{slot::abil}}}}">
</div></div>
{{/if}}
{{/each}}
{{#if {{? {{gettempvar::ablCount}}=0}}}}<div class="abl-item">[없음]</div>{{/if}}
{{/when}}
</div>

{{#when::category::vis::exp}}
<div class="info-grid">
{{#each {{getvar::expList}} exp}}
{{#when::{{dict_element::{{getvar::target}}::{{slot::exp}}}}::isnot::0}}
<div class="talent-tag"><strong>{{slot::exp}}:</strong> {{dict_element::{{getvar::target}}::{{slot::exp}}}}</div>
{{/when}}
{{/each}}
</div>
<div class="line single" style="margin-top:1.5rem"></div>
<p class="total-info" style="margin-top: 1.5rem !important;">
<strong>다음 레벨까지:</strong> {{? {{array_element::{{getvar::Lvtable}}::{{dict_element::{{getvar::target}}::레벨}}}}-{{dict_element::{{getvar::target}}::경험치}}}} EXP<br>
<strong>총 획득 경험치:</strong> {{dict_element::{{getvar::target}}::경험치}} EXP
</p>
{{/when}}

{{#when::category::vis::appearance}}
<div class="appearance-content">
<p><strong>키:</strong> {{dict_element::{{getvar::target}}::키}}cm | <strong>몸무게:</strong> {{dict_element::{{getvar::target}}::몸무게}}kg</p>
<p><strong>헤어스타일:</strong> {{dict_element::{{getvar::target}}::헤어스타일}}</p>
<p><strong>복장:</strong> {{dict_element::{{getvar::target}}::복장}}</p>
<p><strong>가슴:</strong> {{dict_element::{{getvar::target}}::가슴}} | <strong>유두:</strong> {{dict_element::{{getvar::target}}::유두}}</p>
<p><strong>음모:</strong> {{dict_element::{{getvar::target}}::음모}}</p>
{{#when::{{dict_element::{{getvar::target}}::페니스}}::isnot::}}<p><strong>페니스:</strong> {{dict_element::{{getvar::target}}::페니스}}</p>{{/when}}
{{#when::{{dict_element::{{getvar::target}}::자궁정액}}::isnot::0}}<p>자궁에 <strong>{{dict_element::{{getvar::target}}::자궁정액}}ml</strong>의 정액이 들어있습니다.</p>{{/when}}
{{#when::{{dict_element::{{getvar::target}}::애널정액}}::isnot::0}}<p>애널에 <strong>{{dict_element::{{getvar::target}}::애널정액}}ml</strong>의 정액이 들어있습니다.</p>{{/when}}
{{#when::{{dict_element::{{getvar::target}}::문신}}::isnot::}}<p><strong>문신:</strong> {{dict_element::{{getvar::target}}::문신}}</p>{{/when}}
{{#when::{{dict_element::{{getvar::target}}::피어싱}}::isnot::}}<p><strong>피어싱:</strong> {{dict_element::{{getvar::target}}::피어싱}}</p>{{/when}}
</div>
{{/when}}

{{#when::category::vis::narrative}}
<div class="narrative-block">
<h3>첫경험</h3>
<p><strong>첫키스 상대:</strong> {{dict_element::{{getvar::target}}::첫키스 상대}}<br>
<strong>첫경험 상대:</strong> {{dict_element::{{getvar::target}}::첫경험 상대}}</p>
</div>
{{#when::{{dict_element::{{getvar::target}}::가족관계}}::isnot::null}}
<div class="narrative-block"><h3>가족관계</h3><p>{{dict_element::{{getvar::target}}::가족관계}}</p></div>{{/when}}
{{#when::{{dict_element::{{getvar::target}}::용사가 된 동기}}::isnot::null}}
<div class="narrative-block"><h3>용사가 된 동기</h3><p>{{dict_element::{{getvar::target}}::용사가 된 동기}}</p></div>{{/when}}
{{#when::{{dict_element::{{getvar::target}}::용사가 되기 전}}::isnot::null}}
<div class="narrative-block"><h3>용사가 되기 전</h3><p>{{dict_element::{{getvar::target}}::용사가 되기 전}}</p></div>{{/when}}
<!--{{#when::{{? {{array_length::{{dict_element::{{getvar::target}}::이상경험 기록}}}} > 0}}}}
<div class="narrative-block"><h3>이상경험 기록</h3><ul>
{{#each {{dict_element::{{getvar::target}}::이상경험 기록}} R}}<li>{{slot::R}}</li>{{/each}}
</ul></div>{{/when}}    이상경험 출력부 개선안 필요-->
{{/when}}
</div>
</section>

<div class="line single"></div>
{{#when::{{dict_element::{{getvar::target}}::이름}}::isnot::{{user}}}}
<section class="marks-section">
<h2>* 각인</h2>
<div class="marks-grid">
<div class="mark-item"><span class="bar-label">고통:</span> <div class="rating mark {{#when::{{dict_element::{{getvar::target}}::고통각인}}::is::3}}is-full{{/when}}" style="--rating: {{dict_element::{{getvar::target}}::고통각인}}"></div></div>
<div class="mark-item"><span class="bar-label">쾌락:</span> <div class="rating mark {{#when::{{dict_element::{{getvar::target}}::쾌락각인}}::is::3}}is-full{{/when}}" style="--rating: {{dict_element::{{getvar::target}}::쾌락각인}}"></div></div>
<div class="mark-item"><span class="bar-label">공포:</span> <div class="rating mark {{#when::{{dict_element::{{getvar::target}}::공포각인}}::is::3}}is-full{{/when}}" style="--rating: {{dict_element::{{getvar::target}}::공포각인}}"></div></div>
<div class="mark-item"><span class="bar-label">복종:</span> <div class="rating mark {{#when::{{dict_element::{{getvar::target}}::복종각인}}::is::3}}is-full{{/when}}" style="--rating: {{dict_element::{{getvar::target}}::복종각인}}"></div></div>
<div class="mark-item"><span class="bar-label">치욕:</span> <div class="rating mark {{#when::{{dict_element::{{getvar::target}}::치욕각인}}::is::3}}is-full{{/when}}" style="--rating: {{dict_element::{{getvar::target}}::치욕각인}}"></div></div>
<div class="mark-item"><span class="bar-label">반발:</span> <div class="rating mark neg {{#when::{{dict_element::{{getvar::target}}::반발각인}}::is::3}}is-full{{/when}}" style="--rating: {{dict_element::{{getvar::target}}::반발각인}}"></div></div>
</div>
</section>

<div class="line single"></div>

<section class="trace-section">
<h2>* 흔적</h2>
<div class="info-grid">
{{#each {{getvar::traceList}} trace}}
{{#when::{{dict_element::{{getvar::targetTrace}}::{{slot::trace}}}}::isnot::0}}
<div class="talent-tag"><strong>{{slot::trace}}:</strong> {{dict_element::{{getvar::targetTrace}}::{{slot::trace}}}}</div>
{{/when}}
{{/each}}
</div>
</section>

<div class="line single"></div>
{{/when}}

<section class="equipment-section">
<h2>* 장비</h2>
<div class="equipment-grid">
<div class="equipment-item">
<span class="item-type">【무기】</span><span>{{dict_element::{{getvar::target}}::무기}}</span>
</div>
<div class="equipment-item">
<span class="item-type">【방어구】</span><span>{{dict_element::{{getvar::target}}::방어구}}</span>
</div>
<div class="equipment-item">
<span class="item-type">【장신구】</span><span>{{dict_element::{{getvar::target}}::장신구}}</span>
</div>
</div>
</section>

<div class="line single"></div>

<section class="command-panel">
<div class="command-container">
{{getvar::cmds}}
</div>
</section>
</main>

<div class="line double"></div>
<div class="btn command-btn" risu-btn="199">[199] 돌아가기</div>
</div>