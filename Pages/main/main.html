<style>
/* Character Dashboard */
.character-panel { margin-bottom: 1.5rem; }
.character-display { display: flex; gap: 1rem; background: #181818; padding: 1rem; border: 1px solid #282828; border-left: 3px solid #60d9f7; align-items: flex-start; }
.character-portrait { width: 80px; height: 80px; background: #000; border: 1px solid #333; flex-shrink: 0; overflow: hidden; }
.character-portrait img { width: 100%; height: 100%; object-fit: cover; }
.character-info-wrapper { flex-grow: 1; min-width: 0; } /* min-width 0 prevents flex child overflow */

.panel-header { display: flex; justify-content: space-between; align-items: baseline; margin-bottom: 0.5rem; flex-wrap: wrap; }
.panel-header h2 { font-size: 1.1rem; border: none; padding: 0; margin: 0; color: #fff; }
.panel-sub { font-size: 0.8rem; color: #666; }

/* Status Bars in Main */
.player-status { display: flex; flex-direction: column; gap: 0.25rem; }

/* Management Panel */
.management-panel { margin-bottom: 1.5rem; }
.item-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(160px, 1fr)); gap: 0.5rem; }
.inventory-item { background: #222; padding: 0.5rem 0.75rem; border-radius: 2px; font-size: 0.85rem; color: #ccc; border: 1px solid #333; display: flex; justify-content: space-between; }
.inventory-item strong { color: #fff; font-weight: normal; }

.dungeon-floor-grid { display: flex; flex-direction: column; gap: 0.5rem; }
.dungeon-floor { background: #1a1a1a; padding: 0.75rem; border-left: 2px solid #444; font-size: 0.9rem; }
.dungeon-floor strong { color: #60d9f7; margin-right: 0.5rem; }

.section-label { font-size: 0.75rem; color: #666; text-transform: uppercase; margin-bottom: 0.5rem; display: block; border-bottom: 1px solid #222; }

/* Mobile Optimization */
@media screen and (max-width: 400px) {
.character-display { padding: 0.75rem; gap: 0.75rem; }
.character-portrait { width: 60px; height: 60px; }
.panel-header h2 { font-size: 1rem; width: 100%; }
.item-grid { grid-template-columns: 1fr; }
}
</style>

<div class="container">
<header class="header">
<h1>ë©”ì¸ ë©”ë‰´</h1>
<div class="game-info">
<span>Day {{getvar::day}} {{#when::{{? {{? {{floor{{getvar::day}}%29.5}}}} == 15}}}}<span style="color:#fbc02d">ã€Šë§Œì›”ã€‹</span>{{/when}} {{#when::ampm::vis::0}}â˜€ï¸ ë‚®{{:else}}ğŸŒ™ ë°¤{{/when}}</span>
<span>{{getvar::gold}} G</span>
</div>
</header>

<main>
<!-- Character Dashboard -->
<section class="character-panel">
<div class="character-display">
<div class="character-portrait"><img src="{{source::user}}"></div>
<div class="character-info-wrapper">
<div class="panel-header">
<h2>{{user}}</h2>
<span class="panel-sub">Lv. {{dict_element::{{getvar::user}}::ë ˆë²¨}} ë§ˆì™•</span>
</div>
<div class="player-status">
<div class="x-risu-bar-container">
<div class="progress-bar"><div class="x-risu-progress-bar-fill x-risu-hp" style="width: {{calc::{{tonumber::{{dict_element::{{getvar::user}}::ì²´ë ¥}}}} / {{tonumber::{{dict_element::{{getvar::user}}::ìµœëŒ€ì²´ë ¥}}}} * 100}}%;"></div></div>
<span class="bar-value">{{dict_element::{{getvar::user}}::ì²´ë ¥}}</span>
</div>
<div class="x-risu-bar-container">
<div class="progress-bar"><div class="x-risu-progress-bar-fill x-risu-st" style="width: {{calc::{{tonumber::{{dict_element::{{getvar::user}}::ê¸°ë ¥}}}} / {{tonumber::{{dict_element::{{getvar::user}}::ìµœëŒ€ê¸°ë ¥}}}} * 100}}%;"></div></div>
<span class="bar-value">{{dict_element::{{getvar::user}}::ê¸°ë ¥}}</span>
</div>
</div>
</div>
</div>
</section>

<!-- Management Panel -->
<section class="management-panel">
<div class="tabs-container">
<input type="radio" name="tabs" id="items" hidden {{#if {{equal::{{getvar::category}}::items}}}}checked{{/if}}>
<label for="items" class="tabs" risu-btn="items">ë³´ìœ í’ˆ</label>
<input type="radio" name="tabs" id="traps" hidden {{#if {{equal::{{getvar::category}}::traps}}}}checked{{/if}}>
<label for="traps" class="tabs" risu-btn="traps">í•¨ì •</label>
<input type="radio" name="tabs" id="dungeon" hidden {{#if {{equal::{{getvar::category}}::dungeon}}}}checked{{/if}}>
<label for="dungeon" class="tabs" risu-btn="dungeon">ë˜ì „</label>
</div>

<div class="tab-content">
{{#when::category::vis::items}}
{{#if {{? {{dict_element::{{getvar::inventory}}::ì¡°í•©ì§€ì‹}}==1||{{dict_element::{{getvar::inventory}}::ë§ˆê³„ì§€ì‹}}==1||{{dict_element::{{getvar::inventory}}::ê¸ˆë‹¨ì˜ì§€ì‹}}==1}}}}
<span class="section-label">ì§€ì‹</span>
<div class="item-grid" style="margin-bottom:1rem;">
{{#if {{? {{dict_element::{{getvar::inventory}}::ì¡°í•©ì§€ì‹}}==1}}}}<div class="inventory-item"><strong>ì¡°í•©ì§€ì‹</strong></div>{{/if}}
{{#if {{? {{dict_element::{{getvar::inventory}}::ë§ˆê³„ì§€ì‹}}==1}}}}<div class="inventory-item"><strong>ë§ˆê³„ì§€ì‹</strong></div>{{/if}}
{{#if {{? {{dict_element::{{getvar::inventory}}::ê¸ˆë‹¨ì˜ì§€ì‹}}==1}}}}<div class="inventory-item" style="border-color:#880e4f"><strong>ê¸ˆë‹¨ì˜ì§€ì‹</strong></div>{{/if}}
</div>
{{/if}}

<span class="section-label">ë„êµ¬</span>
<div class="item-grid">
{{settempvar::tools::0}}
{{#each {{getvar::ì¡°êµë„êµ¬List}} tool}}
{{#if {{? {{dict_element::{{getvar::inventory}}::{{slot::tool}}}}==1}}}}
<div class="inventory-item"><span>{{slot::tool}}</span></div>
{{settempvar::tools::1}}
{{/if}}
{{/each}}
{{#if {{? {{gettempvar::tools}}==0}}}}<div style="font-size:0.8rem; color:#555;">ë³´ìœ  ë„êµ¬ ì—†ìŒ</div>{{/if}}
</div>

<span class="section-label" style="margin-top:1rem;">ì†Œëª¨í’ˆ</span>
<div class="item-grid">
{{settempvar::consumables::0}}
{{#each {{getvar::ì†Œëª¨í’ˆList}} consumable}}
{{#if {{? {{tonumber::{{dict_element::{{getvar::inventory}}::{{slot::consumable}}}}}}>0}}}}
<div class="inventory-item"><span>{{slot::consumable}}</span> <span>x{{dict_element::{{getvar::inventory}}::{{slot::consumable}}}}</span></div>
{{settempvar::consumables::1}}
{{/if}}
{{/each}}
{{#if {{? {{gettempvar::consumables}}==0}}}}<div style="font-size:0.8rem; color:#555;">ë³´ìœ  ì†Œëª¨í’ˆ ì—†ìŒ</div>{{/if}}
</div>
{{/when}}

{{#when::category::vis::traps}}
<div style="text-align:center; padding:2rem; color:#555;">
<p>ì„¤ì¹˜ëœ í•¨ì •ì´ ì—†ìŠµë‹ˆë‹¤.</p>
</div>
{{/when}}

{{#when::category::vis::dungeon}}
<div style="display:flex; justify-content:space-between; margin-bottom:1rem; font-size:0.85rem; color:#888;">
<span>ë˜ì „ Lv.5</span> <span>í•¨ì • Lv.3</span>
</div>
<div class="dungeon-floor-grid">
<div class="dungeon-floor"><strong>1F</strong> ë¶€í•˜ 50ì²´</div>
<div class="dungeon-floor"><strong>2F</strong> ë¶€í•˜ 35ì²´ / <span style="color:#aaa">ì¸ê°„ëª©ì¥</span></div>
<div class="dungeon-floor"><strong>3F</strong> ë¶€í•˜ 20ì²´ / <span style="color:#aaa">ë¯¸ê¶</span></div>
</div>
<div style="margin-top:1rem; border-top:1px solid #333; padding-top:0.5rem; font-size:0.8rem; color:#666; text-align:right;">
ì¢…í•© ì „ë ¥: 105
</div>
{{/when}}
</div>
</section>

<!-- Command Panel -->
<section class="command-panel">
<span class="section-label">í–‰ë™ ì„ íƒ</span>
<div class="command-container">
{{getvar::cmds}}
</div>
</section>
</main>
</div>