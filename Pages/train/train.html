<style>
.x-risu-progress-bar.x-risu-ej{
height: 0.6rem;
}



/* MODIFIED: Target Profile Section */
.target-profile {
    display: flex;
    flex-wrap: wrap; /* ADDED for responsiveness */
    gap: 1rem;
    align-items: flex-start;
    background-color: #303030;
    padding: 1rem;
    border-radius: 4px;
}

/* NEW: Wrapper for portrait and bars */
.target-visuals {
    display: flex;
    gap: 1rem;
    align-items: flex-start;
    flex-shrink: 0;
}

.character-portrait {
    width: 128px;
    height: 128px;
    background-color: #111;
    border: 1px solid #444;
    flex-shrink: 0;
    border-radius: 8px;
    overflow: hidden;
}

.target-info {
    flex-grow: 1;
    display: flex;
    flex-direction: column;
    gap: 0.75rem; /* Space between header and details */
    min-width: 280px; /* Helps determine wrapping point */
}

.target-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    flex-wrap: wrap;
    gap: 1rem;
}

.target-header h2 {
    margin: 0;
    font-size: 1.5em;
}

/* NEW: Vertical Bars */
.vertical-bars {
    display: flex;
    gap: 0.75rem;
    height: 128px; /* Match portrait height */
    flex-shrink: 0;
}
.v-bar-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.25rem;
    width: 24px;
}
.v-bar-track {
    width: 70%;
    height: 100%;
    background-color: #111;
    border: 1px solid #444;
    border-radius: 4px;
    padding: 2px;
    display: flex;
    flex-direction: column;
    justify-content: flex-end; /* Align fill to bottom */
}
.v-bar-fill {
    width: 100%;
    border-radius: 2px;
    transition: height 0.3s ease-in-out;
}
.v-bar-label {
    font-size: 0.8em;
    font-weight: bold;
}
.v-bar-fill.x-risu-hp { background-image: linear-gradient(to top, #e46557, #eb1d1d); }
.v-bar-fill.x-risu-st { background-image: linear-gradient(to top, #ecd162, #f1c40f); }
.v-bar-fill.x-risu-ej { background-image: linear-gradient(to top, #e06884, #ce025b); }


/* NEW: Target Details Grid */
.target-details-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(8rem, 1fr));
    gap: 0.5rem;
}
.detail-item {
    background-color: #2a2a2a;
    padding: 0.4rem 0.6rem;
    border-radius: 4px;
    font-size: 0.9em;
    display: flex;
    justify-content: space-between;
    align-items: center;
}
.detail-label {
    font-weight: bold;
    color: #ccc;
}
.detail-value {
    color: #fff;
    font-family: monospace;
}

.stats-section h2 {
    font-size: 1.2em;
}

/* MODIFIED: Stats Section Header for Toggle */
.stats-header {
    display: flex;
    /*justify-content: space-between;*/
    align-items: center;
    margin-bottom: 1rem;
    gap: 1rem;
}
.stats-header h2 {
    margin: 0;
}
.toggle-btn {
    cursor: pointer;
    font-size: 0.9em;

}

/* NEW: Logic for showing/hiding stats */
#stats-expanded:checked ~ .stats-header .expand-btn,
#stats-collapsed:checked ~ .stats-header .collapse-btn {
    display: none;
}
#stats-collapsed:checked ~ .stats-grid {
    display: none;
}

.stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(10rem, 1fr));
    gap: 0.5rem;
    background-color: #303030;
    padding: 1rem;
    border-radius: 4px;
}
.stat-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    background-color: #2a2a2a;
    padding: 0.2rem 0.5rem;
    border-radius: 4px;
}
.stat-label {
    font-weight: bold;
}

.ejaculation-section h3 {
    margin-bottom: 0.75rem;
    font-size: 1.1em;
    border-bottom: 1px solid #444;
    padding-bottom: 0.5rem;
}

.log-panel h2 {
    font-size: 1.2em;
}

.log-content {
    background-color: #111;
    border: 1px solid #444;
    padding: 1rem;
    min-height: 100px;
    max-height: 400px;
    overflow-y: auto;
    border-radius: 4px;
    font-family: 'Gulim', monospace;
    font-size: 0.95em;
    line-height: 1.8;
}

.log-content p {
    margin: 0 0 0.5rem 0;
}
.log-content p:last-child {
    margin-bottom: 0;
}

.loading-container {
    grid-column: 1 / -1; /* Span all columns in the command-container grid */
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    padding: 2rem 1rem;
    color: #ccc;
    font-family: 'Gulim', monospace;
    text-align: center;
    min-height: 80px; /* Ensure it has some height */
}

.loading-text {
    font-size: 1.1em;
    margin-bottom: 0.3rem;
}

.loading-dots {
    display: flex;
    gap: 0.75rem;
}

.loading-dots span {
    width: 12px;
    height: 12px;
    background-color: #ffffbf; /* Using a highlight color from the theme */
    border-radius: 50%;
    animation: pulse 1.4s infinite ease-in-out both;
}

.loading-dots .dot-1 {
    animation-delay: -0.32s;
}

.loading-dots .dot-2 {
    animation-delay: -0.16s;
}

@keyframes pulse {
    0%, 80%, 100% {
        transform: scale(0.6);
        opacity: 0.5;
    }
    40% {
        transform: scale(1.0);
        opacity: 1;
    }
}

@media screen and (max-width: 600px) {
    .stats-grid {
        grid-template-columns: repeat(auto-fill, minmax(8rem, 1fr));
        font-size: 0.8rem;
        }
    .stat-label {
        font-size: 0.8rem;
    }
}
</style>

<div class="container">
<div class="line double"></div>

<header class="header">
<h1>▋조교 메뉴</h1>
<div class="game-info">
<span>({{getvar::day}}일째) {{#when::{{? {{? {{floor{{getvar::day}}%29.5}}}} == 15}}}}《만월》 {{/when}}{{#when::ampm::vis::0}}낮{{:else}}밤{{/when}}</span>
</div>
</header>
<main>
<section class="status-panel">
<div class="target-profile">
<div class="target-visuals">
<div class="character-portrait">
<!-- Placeholder for target image variable -->
<img src="{{raw::{{dict_element::{{getvar::target}}::이름}}.png}}" style="margin:0px;border-radius:1em">
</div>
<div class="vertical-bars">
<!-- Vertical HP Bar -->
<div class="v-bar-container" title="{{dict_element::{{getvar::target}}::체력}}">
<div class="v-bar-track">
<div class="v-bar-fill x-risu-hp" style="height: {{? {{tonumber::{{dict_element::{{getvar::target}}::체력}}}} / {{tonumber::{{dict_element::{{getvar::target}}::최대체력}}}} * 100}}%;"></div>
</div>
<span class="v-bar-label">체력</span>
</div>
<!-- Vertical ST Bar -->
<div class="v-bar-container" title="{{dict_element::{{getvar::target}}::최대기력}}">
<div class="v-bar-track">
<div class="v-bar-fill x-risu-st" style="height: {{? {{tonumber::{{dict_element::{{getvar::target}}::기력}}}} / {{tonumber::{{dict_element::{{getvar::target}}::최대기력}}}} * 100}}%;"></div>
</div>
<span class="v-bar-label">기력</span>
</div>
<!-- Vertical Ejaculation Bar -->
<div class="v-bar-container" title="{{? {{getvar::ej_target}}*0.8}}">
<div class="v-bar-track">
<!--최대 게이지를 80%까지만 채워서 가득 찼는데 절정하지 않는 모습을 피함-->
<div class="v-bar-fill x-risu-ej" style="height: {{? {{? {{tonumber::{{getvar::ej_target}}}}*0.8}}/100}}%;"></div>
</div>
<span class="v-bar-label">절정</span>
</div>
</div>
</div>
<div class="target-info">
<div class="target-header">
<h2>{{dict_element::{{getvar::target}}::이름}}</h2>
{{#when {{? {{dict_element::{{getvar::target}}::칭호}}!=}}}}
<div class="char-tags">
<span class="tag tag-{{#when::{{dict_element::{{getvar::target}}::칭호}}::is::음란}}lewd{{/when}}{{#when::{{dict_element::{{getvar::target}}::칭호}}::is::연모}}love{{/when}}{{#when::{{dict_element::{{getvar::target}}::칭호}}::is::암캐}}puppy{{/when}}{{#when::{{dict_element::{{getvar::target}}::칭호}}::is::붕괴}}destroyed{{/when}}{{#when::{{dict_element::{{getvar::target}}::칭호}}::is::광기}}mad{{/when}}"> 〈{{dict_element::{{getvar::target}}::칭호}}〉</span>
</div>
{{/when}}
</div>
<div class="target-details-grid">
<div class="detail-item">
<span class="detail-label">질내정액</span>
<span class="detail-value">{{dict_element::{{getvar::target}}::자궁정액}}ml</span>
</div>
<div class="detail-item">
<span class="detail-label">애널정액</span>
<span class="detail-value">{{dict_element::{{getvar::target}}::애널정액}}ml</span>
</div>
<div class="detail-item">
<span class="detail-label">C절정</span>
<span class="detail-value">{{dict_element::{{getvar::target}}::C쾌락경험}}회</span>
</div>
<div class="detail-item">
<span class="detail-label">V절정</span>
<span class="detail-value">{{dict_element::{{getvar::target}}::V쾌락경험}}회</span>
</div>
<div class="detail-item">
<span class="detail-label">A절정</span>
<span class="detail-value">{{dict_element::{{getvar::target}}::A쾌락경험}}회</span>
</div>
<div class="detail-item">
<span class="detail-label">B절정</span>
<span class="detail-value">{{dict_element::{{getvar::target}}::B쾌락경험}}회</span>
</div>
</div>
</div>
</div>
</section>


<div class="line single"></div>

<section class="stats-section">
<input type="radio" name="stats-toggle" id="stats-expanded" checked hidden>
<input type="radio" name="stats-toggle" id="stats-collapsed" hidden>
<div class="stats-header">
<h2>* Stats</h2>
<div class="toggle-buttons">
<label for="stats-collapsed" class="toggle-btn collapse-btn x-risu-btn">접기</label>
<label for="stats-expanded" class="toggle-btn expand-btn x-risu-btn">펼치기</label>
</div>
</div>
<div class="stats-grid">
<div class="stat-item"><span class="stat-label">C쾌락</span> <div class="rating heart {{#when::{{dict_element::{{getvar::stat}}::C쾌락}}::is::10}}is-full{{/when}}" style="--rating: {{dict_element::{{getvar::stat}}::C쾌락}}"></div></div>
<div class="stat-item"><span class="stat-label">V쾌락</span> <div class="rating heart {{#when::{{dict_element::{{getvar::stat}}::V쾌락}}::is::10}}is-full{{/when}}" style="--rating: {{dict_element::{{getvar::stat}}::V쾌락}}"></div></div>
<div class="stat-item"><span class="stat-label">A쾌락</span> <div class="rating heart {{#when::{{dict_element::{{getvar::stat}}::A쾌락}}::is::10}}is-full{{/when}}" style="--rating: {{dict_element::{{getvar::stat}}::A쾌락}}"></div></div>
<div class="stat-item"><span class="stat-label">B쾌락</span> <div class="rating heart {{#when::{{dict_element::{{getvar::stat}}::B쾌락}}::is::10}}is-full{{/when}}" style="--rating: {{dict_element::{{getvar::stat}}::B쾌락}}"></div></div>
{{#when::{{dict_element::{{getvar::target}}::요도성감}}::vis::1}}
<div class="stat-item"><span class="stat-label">U쾌락</span> <div class="rating heart {{#when::{{dict_element::{{getvar::stat}}::U쾌락}}::is::10}}is-full{{/when}}" style="--rating: {{dict_element::{{getvar::stat}}::U쾌락}}"></div></div>
{{/when}}
{{#when::{{dict_element::{{getvar::target}}::인후성감}}::vis::1}}
<div class="stat-item"><span class="stat-label">M쾌락</span> <div class="rating heart {{#when::{{dict_element::{{getvar::stat}}::M쾌락}}::is::10}}is-full{{/when}}" style="--rating: {{dict_element::{{getvar::stat}}::M쾌락}}"></div></div>
{{/when}}
<div class="stat-item"><span class="stat-label">S쾌락</span> <div class="rating heart {{#when::{{dict_element::{{getvar::stat}}::S쾌락}}::is::10}}is-full{{/when}}" style="--rating: {{dict_element::{{getvar::stat}}::S쾌락}}"></div></div>
<div class="stat-item"><span class="stat-label">V윤활</span> <div class="rating heart {{#when::{{dict_element::{{getvar::stat}}::V윤활}}::is::10}}is-full{{/when}}" style="--rating: {{dict_element::{{getvar::stat}}::V윤활}}"></div></div>
<div class="stat-item"><span class="stat-label">A윤활</span> <div class="rating heart {{#when::{{dict_element::{{getvar::stat}}::A윤활}}::is::10}}is-full{{/when}}" style="--rating: {{dict_element::{{getvar::stat}}::A윤활}}"></div></div>
<div class="stat-item"><span class="stat-label">욕정</span> <div class="rating heart {{#when::{{dict_element::{{getvar::stat}}::욕정}}::is::10}}is-full{{/when}}" style="--rating: {{dict_element::{{getvar::stat}}::욕정}}"></div></div>
<div class="stat-item"><span class="stat-label">온순</span> <div class="rating heart {{#when::{{dict_element::{{getvar::stat}}::온순}}::is::10}}is-full{{/when}}" style="--rating: {{dict_element::{{getvar::stat}}::온순}}"></div></div>
<div class="stat-item"><span class="stat-label">굴복</span> <div class="rating {{#when::{{? {{tonumber::{{dict_element::{{getvar::target}}::봉사기술}}}}>4}}::or::{{? {{tonumber::{{dict_element::{{getvar::target}}::복종각인}}}}>0}}}}heart{{:else}}skull{{/when}} {{#when::{{dict_element::{{getvar::stat}}::굴복}}::is::10}}is-full{{/when}}" style="--rating: {{dict_element::{{getvar::stat}}::굴복}}"></div></div>
<div class="stat-item"><span class="stat-label">습득</span> <div class="rating heart {{#when::{{dict_element::{{getvar::stat}}::습득}}::is::10}}is-full{{/when}}" style="--rating: {{dict_element::{{getvar::stat}}::습득}}"></div></div>
<div class="stat-item"><span class="stat-label">수치</span> <div class="rating {{#when::{{? {{tonumber::{{dict_element::{{getvar::target}}::노출벽}}}}>4}}}}heart{{:else}}skull{{/when}} {{#when::{{dict_element::{{getvar::stat}}::수치}}::is::10}}is-full{{/when}}" style="--rating: {{dict_element::{{getvar::stat}}::수치}}"></div></div>
<div class="stat-item"><span class="stat-label">고통</span> <div class="rating {{#when::{{? {{tonumber::{{dict_element::{{getvar::target}}::마조끼}}}}>4}}}}heart{{:else}}skull{{/when}} {{#when::{{dict_element::{{getvar::stat}}::고통}}::is::10}}is-full{{/when}}" style="--rating: {{dict_element::{{getvar::stat}}::고통}}"></div></div>
<div class="stat-item"><span class="stat-label">공포</span> <div class="rating skull {{#when::{{dict_element::{{getvar::stat}}::공포}}::is::10}}is-full{{/when}}" style="--rating: {{dict_element::{{getvar::stat}}::공포}}"></div></div>
<div class="stat-item"><span class="stat-label">불쾌</span> <div class="rating skull {{#when::{{dict_element::{{getvar::stat}}::불쾌}}::is::10}}is-full{{/when}}" style="--rating: {{dict_element::{{getvar::stat}}::불쾌}}"></div></div>
<div class="stat-item"><span class="stat-label">부정</span> <div class="rating skull {{#when::{{dict_element::{{getvar::stat}}::부정}}::is::10}}is-full{{/when}}" style="--rating: {{dict_element::{{getvar::stat}}::부정}}"></div></div>
</div>
</section>

<div class="line single"></div>

<section class="ejaculation-section">
<h3>* 절정 게이지 ({{user}})</h3>
<div class="x-risu-bar-container">
<span class="bar-label">{{user}}:</span>
<div class="progress-bar x-risu-ej">
<!--최대 게이지를 80%까지만 채워서 가득 찼는데 절정하지 않는 모습을 피함-->
<div class="x-risu-progress-bar-fill x-risu-ej" style="width: {{? {{? {{tonumber::{{getvar::ej_user}}}}*0.8}}/100}}%;"></div>
</div>
<span class="bar-value">{{getvar::ej_user}}/10000</span>
</div>
</section>

<div class="line single"></div>

<section class="log-panel">
<h2>* 메시지</h2>
<div class="log-content">
{{#when::{{? {{getvar::oldLog}}!=}}}}<details>
<summary>이전 조교기록</summary>
{{getvar::oldLog}}
</details>
{{/when}}
{{getvar::newLog}}
{{getvar::statLvUp}}
</div>
</section>

<div class="line single"></div>

<section class="command-panel">
<h3>▋Commands</h3>
<div class="command-container">
{{getVar::cmds}}
</div>
</section>
</main>

<div class="line double"></div>
</div>