<style>
.x-risu-progress-bar.x-risu-ej{
height: 0.6rem;
}

.target-profile {
    display: flex;
    flex-wrap: wrap;
    gap: 1rem;
    align-items: flex-start;
    background-color: #303030;
    padding: 1rem;
    border-radius: 4px;
}

.target-visuals {
    display: flex;
    gap: 1rem;
    align-items: flex-start;
    flex-shrink: 0;
}

.character-portrait {
    width: 128px;
    height: 128px;
    background-color: #111;
    border: 1px solid #444;
    flex-shrink: 0;
    border-radius: 8px;
    overflow: hidden;
}

.target-info {
    flex-grow: 1;
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
    min-width: 280px;
}

.target-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    flex-wrap: wrap;
    gap: 1rem;
}

.target-header h2 {
    margin: 0;
    font-size: 1.5em;
}

.vertical-bars {
    display: flex;
    gap: 0.75rem;
    height: 128px;
    flex-shrink: 0;
}
.v-bar-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.25rem;
    width: 24px;
}
.v-bar-track {
    width: 70%;
    height: 100%;
    background-color: #111;
    border: 1px solid #444;
    border-radius: 4px;
    padding: 2px;
    display: flex;
    flex-direction: column;
    justify-content: flex-end;
}
.v-bar-fill {
    width: 100%;
    border-radius: 2px;
    transition: height 0.3s ease-in-out;
}
.v-bar-label {
    font-size: 0.8em;
    font-weight: bold;
}
.v-bar-fill.x-risu-hp { background-image: linear-gradient(to top, #e46557, #eb1d1d); } /*체력*/
.v-bar-fill.x-risu-st { background-image: linear-gradient(to top, #ecd162, #f1c40f); } /*기력*/
.v-bar-fill.x-risu-pe { background-image: linear-gradient(to top, #ded5b0, #eed87f); } /*요의*/
.v-bar-fill.x-risu-ej { background-image: linear-gradient(to top, #e06884, #ce025b); } /*사정게이지*/

.target-details-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(8rem, 1fr));
    gap: 0.5rem;
}
.detail-item {
    background-color: #2a2a2a;
    padding: 0.4rem 0.6rem;
    border-radius: 4px;
    font-size: 0.9em;
    display: flex;
    justify-content: space-between;
    align-items: center;
}
.detail-label {
    font-weight: bold;
    color: #ccc;
}
.detail-value {
    color: #fff;
    font-family: monospace;
}

.stats-section h2 {
    font-size: 1.2em;
}

.stats-header {
    display: flex;
    /*justify-content: space-between;*/
    align-items: center;
    margin-bottom: 1rem;
    gap: 1rem;
}
.stats-header h2 {
    margin: 0;
}
.toggle-btn {
    cursor: pointer;
    font-size: 0.9em;

}

#stats-expanded:checked ~ .stats-header .expand-btn,
#stats-collapsed:checked ~ .stats-header .collapse-btn {
    display: none;
}
#stats-collapsed:checked ~ .stats-grid {
    display: none;
}

.stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(10rem, 1fr));
    gap: 0.5rem;
    background-color: #303030;
    padding: 1rem;
    border-radius: 4px;
}
.stat-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    background-color: #2a2a2a;
    padding: 0.2rem 0.5rem;
    border-radius: 4px;
}
.stat-label {
    font-weight: bold;
}

.ejaculation-section h3 {
    margin-bottom: 0.75rem;
    font-size: 1.1em;
    border-bottom: 1px solid #444;
    padding-bottom: 0.5rem;
}

.log-panel h2 {
    font-size: 1.2em;
}

.log-content {
    background-color: #111;
    border: 1px solid #444;
    padding: 1rem;
    min-height: 100px;
    max-height: 400px;
    overflow-y: auto;
    border-radius: 4px;
    font-family: 'Gulim', monospace;
    font-size: 0.95em;
    line-height: 1.8;
}

.log-content p {
    margin: 0 0 0.5rem 0;
}
.log-content p:last-child {
    margin-bottom: 0;
}

.loading-container {
    grid-column: 1 / -1;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    padding: 2rem 1rem;
    color: #ccc;
    font-family: 'Gulim', monospace;
    text-align: center;
    min-height: 80px;
}

.loading-text {
    font-size: 1.1em;
    margin-bottom: 0.3rem;
}

.loading-dots {
    display: flex;
    gap: 0.75rem;
}

.loading-dots span {
    width: 12px;
    height: 12px;
    background-color: #ffffbf;
    border-radius: 50%;
    animation: pulse 1.4s infinite ease-in-out both;
}

.loading-dots .dot-1 {
    animation-delay: -0.32s;
}

.loading-dots .dot-2 {
    animation-delay: -0.16s;
}

@keyframes pulse {
    0%, 80%, 100% {
        transform: scale(0.6);
        opacity: 0.5;
    }
    40% {
        transform: scale(1.0);
        opacity: 1;
    }
}

/*성공여부표시 애니메이션*/
.log-wrapper {
position: relative; /* Container for the absolute positioned overlay */
}

.success-animation {
position: absolute;
inset: 0; /* a modern way for top/right/bottom/left: 0 */
z-index: 10;
overflow: hidden; /* Hide panels as they move out */
animation: hide-container 0.2s 0.8s forwards;
}

/* The two black panels covering the content */
.success-animation::before,
.success-animation::after {
content: '';
position: absolute;
top: 0;
width: 50.5%; /* Overlap slightly to prevent a 1px gap during animation */
height: 100%;
background-color: #111; /* Match log background */
animation: open-panels 0.4s ease-in-out 0.6s forwards;
}

.success-animation::before {
left: 0;
transform-origin: left;
}

.success-animation::after {
right: 0;
transform-origin: right;
}

.animation-text {
position: absolute;
top: 50%;
left: 50%;
transform: translate(-50%, -50%);

font-size: 3em;
font-weight: bold;
font-family: 'Arial Black', sans-serif;

z-index: 1; /* Above panels */
white-space: nowrap; /* Prevent text wrapping */
animation: text-appear-and-fade 1s ease-in-out forwards;
}
.success{
    color: #f8c65c;
    text-shadow: 0 0 10px #f8c65c, 0 0 20px #d1843c;
}

.fail{
    color: #dc4747;
    text-shadow: 0 0 10px #f8c65c, 0 0 20px #d1843c;
}

@keyframes text-appear-and-fade {
0% {
opacity: 0;
transform: translate(-50%, -50%) scale(0.8);
}
5% { /* Appear */
opacity: 1;
transform: translate(-50%, -50%) scale(1);
}
100% { /* Fade out */
opacity: 0;
transform: translate(-50%, -50%) scale(1.1);
}
}

@keyframes open-panels {
from {
transform: scaleX(1);
}
to {
transform: scaleX(0);
}
}

@keyframes hide-container {
to {
/* Hides the element and makes it non-interactive */
visibility: hidden;
}
}
/*성공여부표시 애니메이션*/


@media screen and (max-width: 600px) {
    .stats-grid {
        grid-template-columns: repeat(auto-fill, minmax(8rem, 1fr));
        font-size: 0.8rem;
        }
    .stat-label {
        font-size: 0.8rem;
    }
}
</style>

<div class="container">
<div class="line double"></div>

<header class="header">
<h1>▋조교 메뉴</h1>
<div class="game-info">
<span>({{getvar::day}}일째) {{#when::{{? {{? {{floor{{getvar::day}}%29.5}}}} == 15}}}}《만월》 {{/when}}{{#when::ampm::vis::0}}낮{{:else}}밤{{/when}}</span>
</div>
</header>
<main>
<section class="status-panel">
<div class="target-profile">
<div class="target-visuals">
<div class="character-portrait">
<!-- Placeholder for target image variable -->
<img src="{{raw::{{dict_element::{{getvar::target}}::이름}}.png}}" style="margin:0px;border-radius:1em">
</div>
<div class="vertical-bars">
<!-- Vertical HP Bar -->
<div class="v-bar-container">
<div class="v-bar-track">
<div class="v-bar-fill x-risu-hp" style="height: {{? {{tonumber::{{dict_element::{{getvar::target}}::체력}}}} / {{tonumber::{{dict_element::{{getvar::target}}::최대체력}}}} * 100}}%;"></div>
</div>
<span class="v-bar-label">체력</span>
</div>
<!-- Vertical ST Bar -->
<div class="v-bar-container">
<div class="v-bar-track">
<div class="v-bar-fill x-risu-st" style="height: {{? {{tonumber::{{dict_element::{{getvar::target}}::기력}}}} / {{tonumber::{{dict_element::{{getvar::target}}::최대기력}}}} * 100}}%;"></div>
</div>
<span class="v-bar-label">기력</span>
</div>
<!-- Vertical Pee Bar -->
<div class="v-bar-container">
<div class="v-bar-track">
<div class="v-bar-fill x-risu-pe" style="height: {{getvar::요의}}%;"></div>
</div>
<span class="v-bar-label">요의</span>
</div>
<!-- Vertical Ejaculation Bar -->
<div class="v-bar-container" title="{{getvar::ej_target}}/{{? 10000*{{? 1.2^{{getvar::ejCount_t}}}}}}">
<div class="v-bar-track">
<div class="v-bar-fill x-risu-ej" style="height: {{? {{getvar::ej_target}}/{{? 100*{{? 1.2^{{getvar::ejCount_t}}}}}}}}%;"></div>
</div>
<span class="v-bar-label">절정</span>
</div>
</div>
</div>
<div class="target-info">
<div class="target-header">
<h2>{{dict_element::{{getvar::target}}::이름}}</h2>
{{#when {{? {{dict_element::{{getvar::target}}::칭호}}!=}}}}
<div class="char-tags">
<span class="tag tag-{{#when::{{dict_element::{{getvar::target}}::칭호}}::is::음란}}lewd{{/when}}{{#when::{{dict_element::{{getvar::target}}::칭호}}::is::연모}}love{{/when}}{{#when::{{dict_element::{{getvar::target}}::칭호}}::is::암캐}}puppy{{/when}}{{#when::{{dict_element::{{getvar::target}}::칭호}}::is::붕괴}}destroyed{{/when}}{{#when::{{dict_element::{{getvar::target}}::칭호}}::is::광기}}mad{{/when}}"> 〈{{dict_element::{{getvar::target}}::칭호}}〉</span>
</div>
{{/when}}
</div>
<div class="target-details-grid">
<div class="detail-item">
<span class="detail-label">질내정액</span>
<span class="detail-value">{{dict_element::{{getvar::target}}::자궁정액}}ml</span>
</div>
<div class="detail-item">
<span class="detail-label">애널정액</span>
<span class="detail-value">{{dict_element::{{getvar::target}}::애널정액}}ml</span>
</div>
<div class="detail-item">
<span class="detail-label">절정</span>
<span class="detail-value">{{getvar::ejCount_t}}회</span>
</div>
</div>
</div>
</div>
</section>


<div class="line single"></div>

<section class="stats-section">
<input type="radio" name="stats-toggle" id="stats-expanded" checked hidden>
<input type="radio" name="stats-toggle" id="stats-collapsed" hidden>
<div class="stats-header">
<h2>* Stats</h2>
<div class="toggle-buttons">
<label for="stats-collapsed" class="toggle-btn collapse-btn x-risu-btn">접기</label>
<label for="stats-expanded" class="toggle-btn expand-btn x-risu-btn">펼치기</label>
</div>
</div>
<div class="stats-grid">
<div class="stat-item"><span class="stat-label">C쾌락</span> <div class="rating heart {{#when::{{dict_element::{{getvar::stat}}::C쾌락}}::is::10}}is-full{{/when}}" style="--rating: {{dict_element::{{getvar::stat}}::C쾌락}}"></div></div>
<div class="stat-item"><span class="stat-label">V쾌락</span> <div class="rating heart {{#when::{{dict_element::{{getvar::stat}}::V쾌락}}::is::10}}is-full{{/when}}" style="--rating: {{dict_element::{{getvar::stat}}::V쾌락}}"></div></div>
<div class="stat-item"><span class="stat-label">A쾌락</span> <div class="rating heart {{#when::{{dict_element::{{getvar::stat}}::A쾌락}}::is::10}}is-full{{/when}}" style="--rating: {{dict_element::{{getvar::stat}}::A쾌락}}"></div></div>
<div class="stat-item"><span class="stat-label">B쾌락</span> <div class="rating heart {{#when::{{dict_element::{{getvar::stat}}::B쾌락}}::is::10}}is-full{{/when}}" style="--rating: {{dict_element::{{getvar::stat}}::B쾌락}}"></div></div>
{{#when::{{dict_element::{{getvar::target}}::요도성감}}::vis::1}}
<div class="stat-item"><span class="stat-label">U쾌락</span> <div class="rating heart {{#when::{{dict_element::{{getvar::stat}}::U쾌락}}::is::10}}is-full{{/when}}" style="--rating: {{dict_element::{{getvar::stat}}::U쾌락}}"></div></div>
{{/when}}
{{#when::{{dict_element::{{getvar::target}}::인후성감}}::vis::1}}
<div class="stat-item"><span class="stat-label">M쾌락</span> <div class="rating heart {{#when::{{dict_element::{{getvar::stat}}::M쾌락}}::is::10}}is-full{{/when}}" style="--rating: {{dict_element::{{getvar::stat}}::M쾌락}}"></div></div>
{{/when}}
<div class="stat-item"><span class="stat-label">S쾌락</span> <div class="rating heart {{#when::{{dict_element::{{getvar::stat}}::S쾌락}}::is::10}}is-full{{/when}}" style="--rating: {{dict_element::{{getvar::stat}}::S쾌락}}"></div></div>
<div class="stat-item"><span class="stat-label">V윤활</span> <div class="rating heart {{#when::{{dict_element::{{getvar::stat}}::V윤활}}::is::10}}is-full{{/when}}" style="--rating: {{dict_element::{{getvar::stat}}::V윤활}}"></div></div>
<div class="stat-item"><span class="stat-label">A윤활</span> <div class="rating heart {{#when::{{dict_element::{{getvar::stat}}::A윤활}}::is::10}}is-full{{/when}}" style="--rating: {{dict_element::{{getvar::stat}}::A윤활}}"></div></div>
<div class="stat-item"><span class="stat-label">욕정</span> <div class="rating heart {{#when::{{dict_element::{{getvar::stat}}::욕정}}::is::10}}is-full{{/when}}" style="--rating: {{dict_element::{{getvar::stat}}::욕정}}"></div></div>
<div class="stat-item"><span class="stat-label">온순</span> <div class="rating heart {{#when::{{dict_element::{{getvar::stat}}::온순}}::is::10}}is-full{{/when}}" style="--rating: {{dict_element::{{getvar::stat}}::온순}}"></div></div>
<div class="stat-item"><span class="stat-label">굴복</span> <div class="rating {{#when::{{? {{tonumber::{{dict_element::{{getvar::target}}::봉사기술}}}}>4}}::or::{{? {{tonumber::{{dict_element::{{getvar::target}}::복종각인}}}}>0}}}}heart{{:else}}skull{{/when}} {{#when::{{dict_element::{{getvar::stat}}::굴복}}::is::10}}is-full{{/when}}" style="--rating: {{dict_element::{{getvar::stat}}::굴복}}"></div></div>
<div class="stat-item"><span class="stat-label">수치</span> <div class="rating {{#when::{{? {{tonumber::{{dict_element::{{getvar::target}}::노출벽}}}}>4}}}}heart{{:else}}skull{{/when}} {{#when::{{dict_element::{{getvar::stat}}::수치}}::is::10}}is-full{{/when}}" style="--rating: {{dict_element::{{getvar::stat}}::수치}}"></div></div>
<div class="stat-item"><span class="stat-label">고통</span> <div class="rating {{#when::{{? {{tonumber::{{dict_element::{{getvar::target}}::마조끼}}}}>4}}}}heart{{:else}}skull{{/when}} {{#when::{{dict_element::{{getvar::stat}}::고통}}::is::10}}is-full{{/when}}" style="--rating: {{dict_element::{{getvar::stat}}::고통}}"></div></div>
<div class="stat-item"><span class="stat-label">공포</span> <div class="rating skull {{#when::{{dict_element::{{getvar::stat}}::공포}}::is::10}}is-full{{/when}}" style="--rating: {{dict_element::{{getvar::stat}}::공포}}"></div></div>
<div class="stat-item"><span class="stat-label">불쾌</span> <div class="rating skull {{#when::{{dict_element::{{getvar::stat}}::불쾌}}::is::10}}is-full{{/when}}" style="--rating: {{dict_element::{{getvar::stat}}::불쾌}}"></div></div>
<div class="stat-item"><span class="stat-label">저항</span> <div class="rating skull {{#when::{{dict_element::{{getvar::stat}}::저항}}::is::10}}is-full{{/when}}" style="--rating: {{dict_element::{{getvar::stat}}::저항}}"></div></div>
</div>
</section>

<div class="line single"></div>

<section class="ejaculation-section">
<h3>* 절정 게이지 ({{user}})</h3>
<div class="x-risu-bar-container">
<span class="bar-label">{{user}}:</span>
<div class="progress-bar x-risu-ej">
<div class="x-risu-progress-bar-fill x-risu-ej" style="width: {{? {{tonumber::{{getvar::ej_user}}}}/{{? 10000*{{? 1.2^{{tonumber::{{getvar::ejCount_t}}}}}}}}}}%;"></div>
</div>
<span class="bar-value">{{getvar::ej_user}}/{{? 10000*{{? 1.2^{{getvar::ejCount_t}}}}}}</span>
</div>
</section>

<div class="line single"></div>

<section class="log-panel">
<h2>* 메시지</h2>
<div class="log-wrapper">
<div class="log-content">
{{#when::{{? {{getvar::oldLog}}!=[조교시작]}}}}<details>
<summary>이전 조교기록</summary>
{{getvar::oldLog}}
</details>
{{/when}}
{{getvar::newLog}}
{{getvar::statLvUp}}
</div>
{{getvar::sucEffect}}
<!-- 성공실패 예시
<div class="success-animation"><div class="animation-text fail">실패</div></div>
<div class="success-animation"><div class="animation-text success">대성공</div></div>
-->
</div>
</section>

<div class="line single"></div>

<section class="command-panel">
<h3>▋Commands</h3>
<div class="command-container">
{{getVar::cmds}}
</div>
</section>
</main>

<div class="line double"></div>
</div>