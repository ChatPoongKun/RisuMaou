<style>
h3{margin-top: 0;}

.x-risu-progress-bar.x-risu-ej{
height: 0.6rem;
}

.x-risu-bar-label {
font-size: 1rem;
color: #ccc;
}

.status-panel{
    position: sticky;
    top:10px;
    box-shadow: 0 0 20px 10px #121212;
    height:160px
}

.target-profile {
    display: flex;
    flex-wrap: wrap;
    gap: 1rem;
    align-items: flex-start;
    background-color: #1a1a1a;
    padding: 1rem;
    border-radius: 4px;
    border: 1px solid #333;
    height: 160px;
}

.target-visuals {
    display: flex;
    gap: 1rem;
    align-items: flex-start;
    flex-shrink: 0;
}

.character-portrait {
    width: 128px;
    height: 128px;
    background-color: #111;
    border: 1px solid #333;
    flex-shrink: 0;
    border-radius: 8px;
    overflow: hidden;
}

.target-info {
    flex-grow: 1;
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
    /*min-width: 280px;*/
}

.target-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    flex-wrap: wrap;
    gap: 1rem;
}

.target-header h2 {
    margin: 0;
    font-size: 1.5em;
}

.vertical-bars {
    display: flex;
    gap: 0.75rem;
    height: 128px;
    flex-shrink: 0;
}
.v-bar-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.25rem;
    width: 24px;
}
.v-bar-track {
    width: 70%;
    height: 100%;
    background-color: #111;
    border: 1px solid #333;
    border-radius: 4px;
    padding: 2px;
    display: flex;
    flex-direction: column;
    justify-content: flex-end;
}
.v-bar-fill {
    width: 100%;
    border-radius: 2px;
    transition: height 0.3s ease-in-out;
}
.v-bar-label {
    font-size: 0.8em;
    font-weight: bold;
}
.v-bar-fill.x-risu-hp { background-image: linear-gradient(to top, #e46557, #eb1d1d); } /*ì²´ë ¥*/
.v-bar-fill.x-risu-st { background-image: linear-gradient(to top, #ecd162, #f1c40f); } /*ê¸°ë ¥*/
.v-bar-fill.x-risu-pe { background-image: linear-gradient(to top, #ded5b0, #eed87f); } /*ìš”ì˜*/
.v-bar-fill.x-risu-ej { background-image: linear-gradient(to top, #e06884, #ce025b); } /*ì‚¬ì •ê²Œì´ì§€*/

.bar-value{
    flex-basis: 3rem;
}

.target-details-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(8rem, 1fr));
    gap: 0.5rem;
}
.detail-item {
    background-color: #222;
    padding: 0.4rem 0.6rem;
    border-radius: 4px;
    font-size: 0.9em;
    display: flex;
    justify-content: space-between;
    align-items: center;
    border: 1px solid #333;
}
.detail-label {
    font-weight: bold;
    color: #ccc;
}
.detail-value {
    color: #fff;
    font-family: monospace;
}

.stats-section h2 {
    font-size: 1.2em;
}

.stats-header {
    display: flex;
    /*justify-content: space-between;*/
    align-items: center;
    margin-bottom: 0.5rem;
    gap: 1rem;
}
.stats-header h2 {
    margin: 0;
}
.toggle-btn {
    cursor: pointer;
    font-size: 0.9em;

}

#stats-expanded:checked ~ .stats-header .expand-btn,
#stats-collapsed:checked ~ .stats-header .collapse-btn {
    display: none;
}

.stat-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    background-color: #222;
    padding: 0.2rem 0.5rem;
    border-radius: 4px;
    border: 1px solid #333;
}
.stat-label {
    font-weight: bold;
}

.ejaculation-section {
    /*margin-bottom: 0.75rem;*/
    background-color: #1a1a1a;
    border: 1px solid #333;
    border-radius: 4px;
    box-shadow: 0 0 20px 10px #121212;
    font-size: 1.1em;
    padding-bottom: 0.5rem;
    height: 80px;
    position: sticky;
    top:170px;
    padding: 0 5px;
}

.log-panel h2 {
    font-size: 1.2em;
}

.log-content {
    background-color: #111;
    border: 1px solid #333;
    padding: 1rem;
    min-height: 100px;
    max-height: 400px;
    overflow-y: auto;
    border-radius: 4px;
    font-family: 'Gulim', monospace;
    font-size: 0.95em;
    line-height: 1.8;
}

.log-content p {
    margin: 0 0 0.5rem 0;
}
.log-content p:last-child {
    margin-bottom: 0;
}

.loading-container {
    grid-column: 1 / -1;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    padding: 2rem 1rem;
    color: #ccc;
    font-family: 'Gulim', monospace;
    text-align: center;
    min-height: 80px;
}

.loading-text {
    font-size: 1.1em;
    margin-bottom: 0.3rem;
}

.loading-dots {
    display: flex;
    gap: 0.75rem;
}

.loading-dots span {
    width: 12px;
    height: 12px;
    background-color: #ffffbf;
    border-radius: 50%;
    animation: pulse 1.4s infinite ease-in-out both;
}

.loading-dots .dot-1 {
    animation-delay: -0.32s;
}

.loading-dots .dot-2 {
    animation-delay: -0.16s;
}

@keyframes pulse {
    0%, 80%, 100% {
        transform: scale(0.6);
        opacity: 0.5;
    }
    40% {
        transform: scale(1.0);
        opacity: 1;
    }
}


/*ì¡°êµì‹¤íŒ¨&ëŒ€ì„±ê³µ ì „ì—­í™”ë©´íš¨ê³¼*/
.success-animation {
position: absolute;
inset: 0; /* a modern way for top/right/bottom/left: 0 */
z-index: 10;
overflow: hidden; /* Hide panels as they move out */
animation: hide-container 0.2s 0.8s forwards;
}

/* The two black panels covering the content */
.success-animation::before,
.success-animation::after {
content: '';
position: absolute;
top: 0;
width: 50.5%; /* Overlap slightly to prevent a 1px gap during animation */
height: 100%;
background-color: #111; /* Match log background */
animation: open-panels 0.4s ease-in-out 0.6s forwards;
}

.success-animation::before {
left: 0;
transform-origin: left;
}

.success-animation::after {
right: 0;
transform-origin: right;
}

.animation-text {
position: absolute;
top: 50%;
left: 50%;
transform: translate(-50%, -50%);

font-size: 3em;
font-weight: bold;
font-family: 'Arial Black', sans-serif;

z-index: 1; /* Above panels */
white-space: nowrap; /* Prevent text wrapping */
animation: text-appear-and-fade 1s ease-in-out forwards;
}
.success{
    color: #f8c65c;
    text-shadow: 0 0 10px #f8c65c, 0 0 20px #d1843c;
}

.fail{
    color: #dc4747;
    text-shadow: 0 0 10px #f8c65c, 0 0 20px #d1843c;
}

@keyframes text-appear-and-fade {
0% {
opacity: 0;
transform: translate(-50%, -50%) scale(0.8);
}
5% { /* Appear */
opacity: 1;
transform: translate(-50%, -50%) scale(1);
}
100% { /* Fade out */
opacity: 0;
transform: translate(-50%, -50%) scale(1.1);
}
}

@keyframes open-panels {
from {
transform: scaleX(1);
}
to {
transform: scaleX(0);
}
}

@keyframes hide-container {
to {
/* Hides the element and makes it non-interactive */
visibility: hidden;
}
}


/*ê°ì¸íšë“ ì „ì—­í™”ë©´íš¨ê³¼*/
.getMark {
position: absolute;
inset: 0; /* a modern way for top/right/bottom/left: 0 */
z-index: 10;
overflow: hidden; /* Hide panels as they move out */
animation: hide-container 0.4s 1.6s forwards;
}

/* The two black panels covering the content */
.getMark::before,
.getMark::after {
content: '';
position: absolute;
top: 0;
width: 50.5%; /* Overlap slightly to prevent a 1px gap during animation */
height: 100%;
background-color: #111; /* Match log background */
animation: open-panels 0.8s ease-in-out 1.2s forwards;
}

.getMark::before {
left: 0;
transform-origin: left;
}

.getMark::after {
right: 0;
transform-origin: right;
}

.getMarkText {
position: absolute;
top: 50%;
left: 50%;
transform: translate(-50%, -50%);

font-size: 3em;
font-weight: bold;
font-family: 'Arial Black', sans-serif;
color: #f8c65c;
/*text-shadow: 0 0 10px #f8c65c, 0 0 20px #d1843c;*/

z-index: 1; /* Above panels */
white-space: nowrap; /* Prevent text wrapping */
animation: text-appear-and-fade 2.0s ease-in-out forwards;
}

.neggative{
    color: #dc4747;
    /*text-shadow: 0 0 10px #f8c65c, 0 0 20px #d1843c;*/
}

@media screen and (max-width: 600px) {
    .stat-label {
        font-size: 0.8rem;
    }
}
</style>

<div class="container">
<div class="line double"></div>

<header class="header">
<h1>â–‹ì¡°êµ ë©”ë‰´</h1>
<div class="game-info">
<span>Day {{getvar::day}} {{#when::{{? {{? {{floor{{getvar::day}}%29.5}}}} == 15}}}}<span style="color:#fbc02d">ã€Šë§Œì›”ã€‹</span>{{/when}} {{#when::ampm::vis::0}}â˜€ï¸ ë‚®{{:else}}ğŸŒ™ ë°¤{{/when}}</span>
</div>
</header>
<main>
<section class="status-panel">
<div class="target-profile">
<div class="target-visuals">
<h3>* {{dict_element::{{getvar::target}}::ì´ë¦„}}</h3>
<div class="character-portrait">
<!-- Placeholder for target image variable -->
<img src="{{raw::{{dict_element::{{getvar::target}}::ì´ë¦„}}.png}}" style="margin:0px;border-radius:1em">
</div>
<div class="vertical-bars">
<!-- Vertical HP Bar -->
<div class="v-bar-container">
<div class="v-bar-track">
<div class="v-bar-fill x-risu-hp" style="height: {{? {{tonumber::{{dict_element::{{getvar::target}}::ì²´ë ¥}}}} / {{tonumber::{{dict_element::{{getvar::target}}::ìµœëŒ€ì²´ë ¥}}}} * 100}}%;"></div>
</div>
<span class="v-bar-label">ì²´ë ¥</span>
</div>
<!-- Vertical ST Bar -->
<div class="v-bar-container">
<div class="v-bar-track">
<div class="v-bar-fill x-risu-st" style="height: {{? {{tonumber::{{dict_element::{{getvar::target}}::ê¸°ë ¥}}}} / {{tonumber::{{dict_element::{{getvar::target}}::ìµœëŒ€ê¸°ë ¥}}}} * 100}}%;"></div>
</div>
<span class="v-bar-label">ê¸°ë ¥</span>
</div>
<!-- Vertical Pee Bar  ìš”ì˜ì‹œìŠ¤í…œ êµ¬í˜„ í›„ ì¶”ê°€
<div class="v-bar-container">
<div class="v-bar-track">
<div class="v-bar-fill x-risu-pe" style="height: {{getvar::ìš”ì˜}}%;"></div>
</div>
<span class="v-bar-label">ìš”ì˜</span>
</div>-->
<!-- Vertical Ejaculation Bar-->
<div class="v-bar-container" title="{{getvar::ej_target_ratio}}%">
<div class="v-bar-track">
<div class="v-bar-fill x-risu-ej" style="height: {{getvar::ej_target_ratio}}%;"></div>
</div>
<span class="v-bar-label">ì ˆì •</span>
</div>
</div>
</div>
<div class="target-info">
<div class="target-header">

{{#when {{? {{dict_element::{{getvar::target}}::ì¹­í˜¸}}!=}}}}
<div class="char-tags">
<span class="tag tag-{{#when::{{dict_element::{{getvar::target}}::ì¹­í˜¸}}::is::ìŒë€}}lewd{{/when}}{{#when::{{dict_element::{{getvar::target}}::ì¹­í˜¸}}::is::ì—°ëª¨}}love{{/when}}{{#when::{{dict_element::{{getvar::target}}::ì¹­í˜¸}}::is::ì•”ìº}}puppy{{/when}}{{#when::{{dict_element::{{getvar::target}}::ì¹­í˜¸}}::is::ë¶•ê´´}}destroyed{{/when}}{{#when::{{dict_element::{{getvar::target}}::ì¹­í˜¸}}::is::ê´‘ê¸°}}mad{{/when}}"> ã€ˆ{{dict_element::{{getvar::target}}::ì¹­í˜¸}}ã€‰</span>
</div>
{{/when}}
</div>
<!--ê¼­ í•„ìš”í•œ ì •ë³´ì¸ê°€? stickyì— ë„£ì„ ì •ë³´ëŠ” ì•„ë‹ˆë¯€ë¡œ ì–´ë””ì— ë„£ì„ì§€ ì¶”í›„ì— ê³ ë¯¼
<div class="target-details-grid">
<div class="detail-item">
<span class="detail-label">ì§ˆë‚´ì •ì•¡</span>
<span class="detail-value">{{dict_element::{{getvar::target}}::ìê¶ì •ì•¡}}ml</span>
</div>
<div class="detail-item">
<span class="detail-label">ì• ë„ì •ì•¡</span>
<span class="detail-value">{{dict_element::{{getvar::target}}::ì• ë„ì •ì•¡}}ml</span>
</div>
<div class="detail-item">
<span class="detail-label">ì ˆì •</span>
<span class="detail-value">{{getvar::ej_target_count}}íšŒ</span>
</div>
</div>
-->
</div>
</div>
</section>


<div class="line single"></div>

<section class="stats-section">
<input type="radio" name="stats-toggle" id="stats-expanded" {{#if {{? {{getvar::statFold}}=0}}}}checked{{/if}} hidden>
<input type="radio" name="stats-toggle" id="stats-collapsed" {{#if {{? {{getvar::statFold}}=1}}}}checked{{/if}} hidden>
<div class="stats-header">
<h2 style="border: none;">* Stats</h2>
<div class="toggle-buttons" style="display:inline-block">
<label for="stats-collapsed" class="toggle-btn collapse-btn x-risu-btn" risu-btn="close">ì ‘ê¸°</label>
<label for="stats-expanded" class="toggle-btn expand-btn x-risu-btn" risu-btn="open">í¼ì¹˜ê¸°</label>
</div>
</div>
{{#when::statFold::vis::0}}
<div class="info-grid" style="border-top: 1px solid #333; padding-top:0.5rem">
<div class="stat-item"><span class="stat-label">Cì¾Œë½</span> <div class="rating heart {{#when::{{dict_element::{{getvar::stat}}::Cì¾Œë½}}::is::10}}is-full{{/when}}" style="--rating: {{dict_element::{{getvar::stat}}::Cì¾Œë½}}"></div></div>
<div class="stat-item"><span class="stat-label">Vì¾Œë½</span> <div class="rating heart {{#when::{{dict_element::{{getvar::stat}}::Vì¾Œë½}}::is::10}}is-full{{/when}}" style="--rating: {{dict_element::{{getvar::stat}}::Vì¾Œë½}}"></div></div>
<div class="stat-item"><span class="stat-label">Aì¾Œë½</span> <div class="rating heart {{#when::{{dict_element::{{getvar::stat}}::Aì¾Œë½}}::is::10}}is-full{{/when}}" style="--rating: {{dict_element::{{getvar::stat}}::Aì¾Œë½}}"></div></div>
<div class="stat-item"><span class="stat-label">Bì¾Œë½</span> <div class="rating heart {{#when::{{dict_element::{{getvar::stat}}::Bì¾Œë½}}::is::10}}is-full{{/when}}" style="--rating: {{dict_element::{{getvar::stat}}::Bì¾Œë½}}"></div></div>
{{#when::{{dict_element::{{getvar::target}}::ìš”ë„ì„±ê°}}::vis::1}}
<div class="stat-item"><span class="stat-label">Uì¾Œë½</span> <div class="rating heart {{#when::{{dict_element::{{getvar::stat}}::Uì¾Œë½}}::is::10}}is-full{{/when}}" style="--rating: {{dict_element::{{getvar::stat}}::Uì¾Œë½}}"></div></div>
{{/when}}
{{#when::{{dict_element::{{getvar::target}}::ì¸í›„ì„±ê°}}::vis::1}}
<div class="stat-item"><span class="stat-label">Mì¾Œë½</span> <div class="rating heart {{#when::{{dict_element::{{getvar::stat}}::Mì¾Œë½}}::is::10}}is-full{{/when}}" style="--rating: {{dict_element::{{getvar::stat}}::Mì¾Œë½}}"></div></div>
{{/when}}
<!--
Sì¾Œë½ì€ ì¼ë‹¨ ìˆ¨ê²¨ë‘ê¸°
<div class="stat-item"><span class="stat-label">Sì¾Œë½</span> <div class="rating heart {{#when::{{dict_element::{{getvar::stat}}::Sì¾Œë½}}::is::10}}is-full{{/when}}" style="--rating: {{dict_element::{{getvar::stat}}::Sì¾Œë½}}"></div></div>
-->
<div class="stat-item"><span class="stat-label">Vìœ¤í™œ</span> <div class="rating heart {{#when::{{dict_element::{{getvar::stat}}::Vìœ¤í™œ}}::is::10}}is-full{{/when}}" style="--rating: {{dict_element::{{getvar::stat}}::Vìœ¤í™œ}}"></div></div>
<div class="stat-item"><span class="stat-label">Aìœ¤í™œ</span> <div class="rating heart {{#when::{{dict_element::{{getvar::stat}}::Aìœ¤í™œ}}::is::10}}is-full{{/when}}" style="--rating: {{dict_element::{{getvar::stat}}::Aìœ¤í™œ}}"></div></div>
<div class="stat-item"><span class="stat-label">ìš•ì •</span> <div class="rating heart {{#when::{{dict_element::{{getvar::stat}}::ìš•ì •}}::is::10}}is-full{{/when}}" style="--rating: {{dict_element::{{getvar::stat}}::ìš•ì •}}"></div></div>
<div class="stat-item"><span class="stat-label">ì˜¨ìˆœ</span> <div class="rating heart {{#when::{{dict_element::{{getvar::stat}}::ì˜¨ìˆœ}}::is::10}}is-full{{/when}}" style="--rating: {{dict_element::{{getvar::stat}}::ì˜¨ìˆœ}}"></div></div>
<div class="stat-item"><span class="stat-label">êµ´ë³µ</span> <div class="rating {{#when::{{? {{tonumber::{{dict_element::{{getvar::target}}::ë´‰ì‚¬ê¸°ìˆ }}}}>4}}::or::{{? {{tonumber::{{dict_element::{{getvar::target}}::ë³µì¢…ê°ì¸}}}}>0}}}}heart{{:else}}skull{{/when}} {{#when::{{dict_element::{{getvar::stat}}::êµ´ë³µ}}::is::10}}is-full{{/when}}" style="--rating: {{dict_element::{{getvar::stat}}::êµ´ë³µ}}"></div></div>
<div class="stat-item"><span class="stat-label">ìˆ˜ì¹˜</span> <div class="rating {{#when::{{? {{tonumber::{{dict_element::{{getvar::target}}::ë…¸ì¶œë²½}}}}>4}}}}heart{{:else}}skull{{/when}} {{#when::{{dict_element::{{getvar::stat}}::ìˆ˜ì¹˜}}::is::10}}is-full{{/when}}" style="--rating: {{dict_element::{{getvar::stat}}::ìˆ˜ì¹˜}}"></div></div>
<div class="stat-item"><span class="stat-label">ê³ í†µ</span> <div class="rating {{#when::{{? {{tonumber::{{dict_element::{{getvar::target}}::ë§ˆì¡°ë¼}}}}>4}}}}heart{{:else}}skull{{/when}} {{#when::{{dict_element::{{getvar::stat}}::ê³ í†µ}}::is::10}}is-full{{/when}}" style="--rating: {{dict_element::{{getvar::stat}}::ê³ í†µ}}"></div></div>
<div class="stat-item"><span class="stat-label">ê³µí¬</span> <div class="rating skull {{#when::{{dict_element::{{getvar::stat}}::ê³µí¬}}::is::10}}is-full{{/when}}" style="--rating: {{dict_element::{{getvar::stat}}::ê³µí¬}}"></div></div>
<div class="stat-item"><span class="stat-label">ë¶ˆì¾Œ</span> <div class="rating skull {{#when::{{dict_element::{{getvar::stat}}::ë¶ˆì¾Œ}}::is::10}}is-full{{/when}}" style="--rating: {{dict_element::{{getvar::stat}}::ë¶ˆì¾Œ}}"></div></div>
<div class="stat-item"><span class="stat-label">ì €í•­</span> <div class="rating skull {{#when::{{dict_element::{{getvar::stat}}::ì €í•­}}::is::10}}is-full{{/when}}" style="--rating: {{dict_element::{{getvar::stat}}::ì €í•­}}"></div></div>
</div>
{{/when}}
</section>
<div class="line single"></div>

<section class="ejaculation-section">
<h3 style="margin-top: 0.5rem;">* {{user}}</h3>
<div class="x-risu-bar-container">
<span class="bar-label"> ì ˆì •:</span>
<div class="progress-bar">
<div class="x-risu-progress-bar-fill x-risu-ej" style="width: {{getvar::ej_user_ratio}}%;"></div>
</div>
<span class="bar-value">{{getvar::ej_user_ratio}}%</span>
</div>
</section>

<div class="line single"></div>

<section class="log-panel">
<h2>* ë©”ì‹œì§€</h2>
<div class="log-wrapper">
<div class="log-content">
{{#when::{{? {{getvar::oldLog}}!=[ì¡°êµì‹œì‘]}}}}<details>
<summary>ì´ì „ ì¡°êµê¸°ë¡</summary>
{{getvar::oldLog}}
</details>
{{/when}}
{{getvar::newLog}}
{{getvar::statLvUp}}
</div>

<!-- ì„±ê³µì‹¤íŒ¨ ì˜ˆì‹œ
<div class="success-animation"><div class="animation-text fail">ì‹¤íŒ¨</div></div>
<div class="success-animation"><div class="animation-text success">ëŒ€ì„±ê³µ</div></div>
-->
</div>
</section>

<div class="line single"></div>

<div class="tabs-container">
<div class="tabs {{#if {{equal::{{getvar::category}}::ì• ë¬´ê³„}}}}active{{/if}}" risu-btn="1">[1] ì• ë¬´ê³„</div>
<div class="tabs {{#if {{equal::{{getvar::category}}::ë„êµ¬ê³„}}}}active{{/if}}" risu-btn="2">[2] ë„êµ¬ê³„</div>
{{#when::{{dict_element::{{getvar::target}}::ì„±ë³„}}::isnot::ë‚¨ì„±}}
{{#when::{{dict_element::{{getvar::user}}::ì„±ë³„}}::isnot::ì—¬ì„±}}
<div class="tabs {{#if {{equal::{{getvar::category}}::Vê³„}}}}active{{/if}}" risu-btn="3">[3] Vê³„</div>
{{/when}}
{{/when}}
{{#when::{{dict_element::{{getvar::user}}::ì„±ë³„}}::isnot::ì—¬ì„±}}
<div class="tabs {{#if {{equal::{{getvar::category}}::Aê³„}}}}active{{/if}}" risu-btn="4">[4] Aê³„</div>
{{/when}}
<div class="tabs {{#if {{equal::{{getvar::category}}::ë´‰ì‚¬ê³„}}}}active{{/if}}" risu-btn="5">[5] ë´‰ì‚¬ê³„</div>
<div class="tabs {{#if {{equal::{{getvar::category}}::ì†Œëª¨í’ˆ}}}}active{{/if}}" risu-btn="6">[6] ì†Œëª¨í’ˆ</div>
{{#when::{{? {{tonumber::{{dict_element::{{getvar::target}}::ë ˆë²¨}}}}>3}}}}
<div class="tabs {{#if {{equal::{{getvar::category}}::í•˜ë“œê³„}}}}active{{/if}}" risu-btn="9">[9] í•˜ë“œê³„</div>
{{/when}}
</div>
<div class="tab-content">
<div class="command-container">
{{getVar::cmds}}
{{#when::cmds::vis::}}ê°€ëŠ¥í•œ ì¡°êµ ì—†ìŒ{{/when}}
</div>
{{getvar::screenEffect}}
</div>

</main>

<div class="line double"></div>
<div class="btn command-btn" risu-btn="199">ì¡°êµì¢…ë£Œ</div>
</div>